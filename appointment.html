<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حجز موعد - متجر الكمبيوتر</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyCxZZ4dYqrxJ_rlMcXmZhx5Kwg_ZeYnYog",
    authDomain: "computer-store-4c946.firebaseapp.com",
    projectId: "computer-store-4c946",
    storageBucket: "computer-store-4c946.appspot.com",
    messagingSenderId: "77513680070",
    appId: "1:77513680070:web:2d2c080956a16587c4a3c7"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

<style>
:root{
    --primary:#4361ee;
    --secondary:#3a0ca3;
    --bg:#f4f6fb;
    --card:#ffffff;
    --text:#212529;
    --radius:16px;
}

*{box-sizing:border-box;font-family:'Segoe UI',Tahoma}
body{
    margin:0;
    background:linear-gradient(135deg,#eef2ff,#f8f9ff);
    color:var(--text);
}

/* ===== Navbar ===== */
.navbar{
    background:#fff;
    position:sticky;
    top:0;
    z-index:1000;
    box-shadow:0 6px 25px rgba(0,0,0,.08);
}
.navbar .container{
    max-width:1200px;
    margin:auto;
    padding:15px 20px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.logo{
    font-size:22px;
    font-weight:800;
    color:var(--primary);
    text-decoration:none;
}
.nav-links{
    list-style:none;
    display:flex;
    gap:20px;
}
.nav-links a{
    text-decoration:none;
    color:var(--text);
    font-weight:500;
    padding:6px 10px;
    border-radius:8px;
}
.nav-links a:hover{
    background:var(--primary);
    color:#fff;
}

/* ===== Main Card ===== */
.main{
    display:flex;
    justify-content:center;
    padding:40px 15px 120px;
}
.card{
    width:100%;
    max-width:620px;
    background:var(--card);
    padding:35px;
    border-radius:22px;
    box-shadow:0 20px 50px rgba(0,0,0,.12);
    animation:fadeUp .6s ease;
}
@keyframes fadeUp{
    from{opacity:0;transform:translateY(30px)}
    to{opacity:1;transform:none}
}
.card h2{
    text-align:center;
    color:var(--primary);
    margin-bottom:25px;
}

/* ===== Form ===== */
.form-group{
    margin-bottom:16px;
}
.form-group input,
.form-group textarea{
    width:100%;
    padding:15px;
    border-radius:14px;
    border:1px solid #ddd;
    font-size:15px;
    background:#fafafa;
    transition:.3s;
}
.form-group input:focus,
.form-group textarea:focus{
    border-color:var(--primary);
    background:#fff;
    outline:none;
    box-shadow:0 0 0 3px rgba(67,97,238,.15);
}

/* ===== Button ===== */
button{
    width:100%;
    padding:16px;
    border:none;
    border-radius:16px;
    background:linear-gradient(135deg,var(--primary),var(--secondary));
    color:#fff;
    font-size:18px;
    cursor:pointer;
    transition:.3s;
}
button:hover{
    transform:translateY(-2px);
    box-shadow:0 12px 30px rgba(67,97,238,.4);
}

/* ===== Status ===== */
.success{
    display:none;
    margin-top:15px;
    text-align:center;
    color:#22c55e;
    font-weight:700;
}
.status{
    margin-top:10px;
    text-align:center;
    font-weight:600;
}

/* ===== Social Floating ===== */
.social-float{
    position:fixed;
    top:50%;
    left:16px;
    transform:translateY(-50%);
    display:flex;
    flex-direction:column;
    gap:12px;
    z-index:2000;
}
.social{
    width:46px;
    height:46px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    color:#fff;
    font-size:20px;
    box-shadow:0 10px 25px rgba(0,0,0,.3);
    transition:.3s;
}
.social:hover{transform:scale(1.15)}
.social.facebook{background:#1877f2}
.social.tiktok{background:#000}
.social.instagram{
    background:linear-gradient(45deg,#f58529,#dd2a7b,#8134af,#515bd4);
}

/* ===== Bottom Nav ===== */
.bottom-nav{
    position:fixed;
    bottom:0;
    width:100%;
    background:#fff;
    display:flex;
    justify-content:space-around;
    padding:8px 0;
    box-shadow:0 -6px 20px rgba(0,0,0,.1);
    z-index:1500;
}
.bottom-nav a{
    text-decoration:none;
    color:#555;
    font-size:12px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:4px;
}
.bottom-nav a i{
    font-size:18px;
    color:var(--primary);
}

/* ===== Mobile ===== */
@media(max-width:768px){
    .nav-links{display:none}
    .card{padding:25px}
}
/* إخفاء الشريط السفلي في الديسكتوب */
@media (min-width: 769px){
    .bottom-nav{
        display:none !important;
    }
}

</style>
</head>

<body>

<nav class="navbar">
<div class="container">
    <a href="index.html" class="logo">CH-hospital </a>
    <ul class="nav-links">
        <li><a href="index.html">الرئيسية</a></li>
        <li><a href="products.html">المنتجات</a></li>
        <li><a href="appointment.html">حجز موعد</a></li>
        <li><a href="profile.html">الملف الشخصي</a></li>
    </ul>
</div>
</nav>

<div class="main">
<div class="card">
    <h2><i class="fa fa-calendar-check"></i> حجز موعد</h2>

    <div class="form-group"><input type="text" id="name" placeholder="الاسم الكامل"></div>
    <div class="form-group"><input type="email" id="email" placeholder="البريد الإلكتروني"></div>
    <div class="form-group"><input type="tel" id="phone" placeholder="رقم الهاتف"></div>
    <div class="form-group"><input type="date" id="date"></div>
    <div class="form-group"><input type="time" id="time"></div>
    <div class="form-group"><textarea id="notes" rows="4" placeholder="ملاحظات إضافية"></textarea></div>

    <button onclick="bookAppointment()">تأكيد الحجز</button>

    <p class="success" id="successMsg">تم إرسال طلب الحجز بنجاح ✅</p>
    <p class="status" id="statusMsg"></p>
</div>
</div>

<!-- Social -->
<div class="social-float">
  <a href="https://facebook.com" class="social facebook"><i class="fab fa-facebook-f"></i></a>
  <a href="https://tiktok.com" class="social tiktok"><i class="fab fa-tiktok"></i></a>
  <a href="https://instagram.com" class="social instagram"><i class="fab fa-instagram"></i></a>
</div>

<!-- Bottom Nav -->
<div class="bottom-nav">
  <a href="index.html"><i class="fas fa-home"></i><span>الرئيسية</span></a>
  <a href="products.html"><i class="fas fa-laptop"></i><span>المنتجات</span></a>
  <a href="cart.html"><i class="fas fa-shopping-cart"></i><span>العربة</span></a>
  <a href="appointment.html"><i class="fas fa-calendar"></i><span>موعد</span></a>
  <a href="profile.html"><i class="fas fa-user"></i><span>حسابي</span></a>
  <a href="admin.html" style="display:none"><i class="fas fa-cogs"></i><span>لوحة التحكم</span></a>
</div>

<!-- ⚠️ JavaScript كما هو بدون أي تعديل -->
<script>
auth.onAuthStateChanged(user=>{
    if(!user){
        alert("يجب تسجيل الدخول");
        location.href="login.html";
        return;
    }
    document.getElementById("email").value = user.email;
    document.getElementById("email").disabled = true;
    loadStatus(user.uid);
});

async function bookAppointment(){
    const user = auth.currentUser;
    if(!user) return;

    const data={
        userId:user.uid,
        name:name.value.trim(),
        email:user.email,
        phone:phone.value.trim(),
        date:date.value,
        time:time.value,
        notes:notes.value.trim(),
        status:"pending",
        createdAt:firebase.firestore.FieldValue.serverTimestamp()
    };

    if(!data.name || !data.phone || !data.date || !data.time){
        alert("يرجى ملء جميع الحقول");
        return;
    }

    await db.collection("appointments").add(data);
    successMsg.style.display="block";
    loadStatus(user.uid);
}

async function loadStatus(uid){
    const q = await db.collection("appointments")
        .where("userId","==",uid)
        .orderBy("createdAt","desc")
        .limit(1)
        .get();

    if(q.empty) return;
    const s = q.docs[0].data().status;
    if(s==="accepted"){
        statusMsg.textContent="تم قبول الحجز ✅";
        statusMsg.style.color="green";
    }else if(s==="rejected"){
        statusMsg.textContent="تم رفض الحجز ❌";
        statusMsg.style.color="red";
    }else{
        statusMsg.textContent="الحجز قيد المراجعة ⏳";
        statusMsg.style.color="#f0ad4e";
    }
}
</script>

</body>
</html>
