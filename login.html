<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تسجيل الدخول - متجر الكمبيوتر</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyCxZZ4dYqrxJ_rlMcXmZhx5Kwg_ZeYnYog",
    authDomain: "computer-store-4c946.firebaseapp.com",
    projectId: "computer-store-4c946"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:'Poppins',sans-serif;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background: linear-gradient(-45deg, #4361ee, #4cc9f0, #3a0ca3, #7209b7);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
}

@keyframes gradientBG{
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
}

.container{
    background:white;
    width:380px;
    padding:50px 35px;
    border-radius:25px;
    box-shadow:0 20px 50px rgba(0,0,0,0.2);
    text-align:center;
    position:relative;
    animation: slideFade 1s ease forwards;
    opacity:0;
    transform: translateY(50px);
}
@keyframes slideFade{
    to{opacity:1; transform: translateY(0);}
}

.logo{
    width:100px;
    height:100px;
    margin:auto;
    margin-bottom:20px;
    border-radius:50%;
    overflow:hidden;
    box-shadow:0 5px 20px rgba(0,0,0,0.2);
}
.logo img{
    width:100%;
    height:100%;
    object-fit:cover;
}

h2{
    color:#4361ee;
    font-size:28px;
    margin-bottom:30px;
    font-weight:700;
}

.input-group{
    position:relative;
    margin-bottom:20px;
}
.input-group input{
    width:100%;
    padding:14px 45px 14px 14px;
    border-radius:12px;
    border:1px solid #ddd;
    font-size:16px;
    transition: all 0.3s ease;
}
.input-group input:focus{
    border-color:#4361ee;
    box-shadow:0 0 10px rgba(67,97,238,0.3);
    outline:none;
}
.input-group i{
    position:absolute;
    top:50%;
    right:12px;
    transform:translateY(-50%);
    color:#4361ee;
    font-size:18px;
}

button{
    width:100%;
    padding:16px;
    border:none;
    border-radius:12px;
    background: linear-gradient(135deg,#4361ee,#4cc9f0);
    color:white;
    font-weight:600;
    font-size:16px;
    cursor:pointer;
    transition: all 0.3s ease;
    overflow:hidden;
    position:relative;
    margin-bottom:10px;
}
button:hover{
    background: linear-gradient(135deg,#4cc9f0,#4361ee);
    transform: translateY(-3px);
    box-shadow:0 10px 20px rgba(67,97,238,0.3);
}
button:active::after{
    content:'';
    position:absolute;
    width:100%;
    height:100%;
    background:rgba(255,255,255,0.2);
    top:0; left:0;
    border-radius:12px;
}

.message{
    color:#e63946;
    margin-top:12px;
    min-height:20px;
    font-weight:500;
}

p{
    margin-top:15px;
    font-size:14px;
    color:#555;
}
p a{
    color:#4361ee;
    text-decoration:none;
    font-weight:600;
    transition: all 0.3s ease;
}
p a:hover{
    color:#4cc9f0;
}

@media (max-width:400px){
    .container{width:90%; padding:40px 20px;}
}
</style>
</head>

<body>

<div class="container">
    <div class="logo">
        <img src="https://images.unsplash.com/photo-1603791440384-56cd371ee9a7?crop=entropy&cs=tinysrgb&fit=crop&h=100&w=100" alt="شعار المتجر">
    </div>
    <h2>تسجيل الدخول</h2>

    <div class="input-group">
        <input type="email" id="email" placeholder="البريد الإلكتروني">
        <i class="fas fa-envelope"></i>
    </div>

    <div class="input-group">
        <input type="password" id="password" placeholder="كلمة المرور">
        <i class="fas fa-lock"></i>
    </div>

    <button id="loginBtn">تسجيل الدخول</button>
    <button id="guestBtn" style="background:#6c757d;">الدخول كضيف</button>

    <p class="message" id="msg"></p>
    <p>ليس لديك حساب؟ <a href="register.html">سجل هنا</a></p>
</div>

<script>
// تسجيل الدخول العادي
document.getElementById('loginBtn').addEventListener('click', async ()=>{
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    const msg = document.getElementById('msg');
    msg.textContent = '';

    if(!email || !password){ msg.textContent = "يرجى إدخال البريد الإلكتروني وكلمة المرور"; return; }

    try{
        const userCredential = await auth.signInWithEmailAndPassword(email,password);
        const user = userCredential.user;
        const doc = await db.collection('users').doc(user.uid).get();
        if(!doc.exists){ msg.textContent = "حسابك غير موجود في قاعدة البيانات."; return; }
        const userData = doc.data();
        if(userData.role === "admin"){
            window.location.href = "admin.html";
        } else {
            window.location.href = "index.html";
        }
    } catch(err){
        msg.textContent = err.message;
    }
});

// تسجيل الدخول كضيف
document.getElementById('guestBtn').addEventListener('click', ()=>{
    // يمكن تخزين علامة في localStorage لتحديد أنه ضيف
    localStorage.setItem('guestUser','true');
    window.location.href = "index.html";
});
</script>

</body>
</html>
